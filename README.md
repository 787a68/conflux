# conflux åº”ç”¨ç®€ä»‹

**conflux** æ˜¯ä¸€ä¸ªä¸“ä¸º Surge ç”¨æˆ·è®¾è®¡çš„å¤šæœºåœºè®¢é˜…èšåˆã€èŠ‚ç‚¹å¥åº·æ£€æµ‹ä¸æ™ºèƒ½å¯¼å‡ºå·¥å…·ã€‚å®ƒè‡ªåŠ¨æ‹‰å–å¤šä¸ªæœºåœºè®¢é˜…ï¼Œè¿›è¡ŒèŠ‚ç‚¹å»é‡ã€DNS è£‚å˜ã€SNI è¡¥å…¨ã€å‡ºå£ GEO æ£€æµ‹ï¼Œå¹¶æœ€ç»ˆç”Ÿæˆ Surge æ ¼å¼çš„å¤–éƒ¨ä»£ç†åˆ—è¡¨é…ç½®ï¼Œä¾¿äº Surge å®¢æˆ·ç«¯ç›´æ¥å¯¼å…¥å’Œä½¿ç”¨ã€‚

---

## ä¸»è¦ç‰¹æ€§

- æ¯24å°æ—¶è‡ªåŠ¨æ›´æ–°å¤šæœºåœºè®¢é˜…èšåˆï¼Œè‡ªåŠ¨åˆå¹¶èŠ‚ç‚¹  
- èŠ‚ç‚¹å¥åº·æ£€æµ‹ï¼Œè‡ªåŠ¨ GEO/Emoji é‡å‘½å  
- æ™ºèƒ½å»é‡ä¸ DNS è£‚å˜ï¼ŒSNI è¡¥å…¨  
- è¾“å‡º Surge æ ¼å¼èŠ‚ç‚¹é…ç½®  
- å†…ç½® HTTP APIï¼Œæ”¯æŒ token è®¤è¯ã€å‚æ•°è¦†ç›–ã€å¼ºåˆ¶åˆ·æ–°  
- Docker æç®€éƒ¨ç½²ï¼Œç›´æ¥æ‹‰å–é•œåƒå³å¯è¿è¡Œ  

---

## ç¯å¢ƒå˜é‡è¯´æ˜

| å˜é‡å   | æ˜¯å¦å¿…éœ€ | è¯´æ˜                                                                      | ç¤ºä¾‹                                                                                   |
|----------|:--------:|---------------------------------------------------------------------------|----------------------------------------------------------------------------------------|
| SUB      |   å¿…éœ€   | æœºåœºè®¢é˜…åˆ—è¡¨ï¼Œæ ¼å¼ `æœºåœºå=è®¢é˜…é“¾æ¥\|\|æœºåœºå2=è®¢é˜…é“¾æ¥2`ï¼Œæ”¯æŒå¤šä¸ªæœºåœºèšåˆ  | `SUB="æœºåœºA=https://xxx/subscribeA\|\|æœºåœºB=https://xxx/subscribeB"`                       |
| TOKEN    |   å¯é€‰   | API è®¿é—®è®¤è¯ tokenï¼Œæœªè®¾ç½®æ—¶è‡ªåŠ¨ç”Ÿæˆå¹¶ä¿å­˜åœ¨ `/data/conflux/token`         | `TOKEN="your_token"`                                                                    |
| GISTS    |   å¯é€‰   | è‡ªåŠ¨ä¸Šä¼  `node.conf` åˆ° GitHub Gistsï¼Œæ ¼å¼ `token@gist_id`                 | `GISTS="ghp_xxx@1234567890abcdef"`                                      |

> **è¯´æ˜ï¼š**  
> - `SUB` æ˜¯æœ€æ ¸å¿ƒçš„ç¯å¢ƒå˜é‡ï¼Œå†³å®š conflux æ‹‰å–å“ªäº›æœºåœºçš„èŠ‚ç‚¹ã€‚  
> - `TOKEN` ç”¨äº API è®¤è¯ï¼Œå»ºè®®è®¾ç½®ï¼Œé˜²æ­¢æœªæˆæƒè®¿é—®ã€‚  
> - `GISTS` ä»…åœ¨éœ€è¦å°†èŠ‚ç‚¹é…ç½®åŒæ­¥åˆ° GitHub Gists æ—¶è®¾ç½®ã€‚  

---

## URL å‚æ•°è¯´æ˜ï¼ˆAPI è®¿é—®æ—¶å¯ç”¨ï¼‰

| å‚æ•°å | è¯´æ˜                                                                                              | ç¤ºä¾‹           |
|--------|---------------------------------------------------------------------------------------------------|----------------|
| `t`    | è®¤è¯ tokenï¼Œéœ€ä¸ç¯å¢ƒå˜é‡ `TOKEN` ä¿æŒä¸€è‡´æˆ–è¯»å–è‡ªåŠ¨ç”Ÿæˆçš„ token æ–‡ä»¶                             | `t=your_token` |
| `f`    | å¼ºåˆ¶åˆ·æ–°èŠ‚ç‚¹è®¢é˜…å’Œæ£€æµ‹ï¼Œè§¦å‘ `updateNodes` æµç¨‹ï¼›åªéœ€ä¼ é€’å‚æ•°ï¼Œæ— éœ€èµ‹å€¼                           | `f`            |
| `udp`  | è¦†ç›–æ‰€æœ‰èŠ‚ç‚¹çš„ `udp-relay` å‚æ•°ï¼ˆ`1`=å¼€å¯ï¼Œ`0`=å…³é—­ï¼‰                                             | `udp=1`        |
| `quic` | è¦†ç›–æ‰€æœ‰èŠ‚ç‚¹çš„ `block-quic` å‚æ•°ï¼ˆ`1`=å¼€å¯ï¼Œ`0`=å…³é—­ï¼‰                                           | `quic=1`       |
| `tfo`  | è¦†ç›–æ‰€æœ‰èŠ‚ç‚¹çš„ `tfo` å‚æ•°ï¼ˆ`1`=å¼€å¯ï¼Œ`0`=å…³é—­ï¼‰                                                  | `tfo=1`        |

> **è¯´æ˜ï¼š**  
> - åªæœ‰ `udp`ã€`quic`ã€`tfo` è¿™ä¸‰ä¸ªå‚æ•°æ”¯æŒé€šè¿‡ URL åŠ¨æ€è¦†ç›–èŠ‚ç‚¹å±æ€§ã€‚  
> - è®¿é—® API æ—¶ï¼Œå¿…é¡»å¸¦ä¸Š `t` å‚æ•°ï¼ˆtokenï¼‰ï¼Œå¦åˆ™æ— æ³•è·å–èŠ‚ç‚¹é…ç½®ã€‚  
> - **å¼ºåˆ¶åˆ·æ–°ï¼ˆ`f`ï¼‰åªéœ€å¸¦å‚æ•°å³å¯ï¼Œæ— éœ€èµ‹å€¼ã€‚**  

---

## Docker å¿«é€Ÿä½¿ç”¨

ç›´æ¥æ‹‰å–å¹¶è¿è¡Œé•œåƒï¼š

```
docker run -d --name conflux -p 80:80 \
  -e SUB="æœºåœºA=https://xxx/subscribeA||æœºåœºB=https://xxx/subscribeB" \
  -e TOKEN="your_token" \
  787a68/conflux:latest
``` 

--- 

## Surge è®¢é˜…é…ç½®

åœ¨ Surge çš„ [Proxy Group] ä¸­å¡«å†™ï¼š

```
LUX = select, policy-path=https://<your_host>:80/conflux?t=your_token
```

å¦‚éœ€å¼ºåˆ¶åˆ·æ–°èŠ‚ç‚¹ï¼š
```
https://<your_host>:80/conflux?t=your_token&f
```

å¦‚éœ€åŠ¨æ€æ§åˆ¶èŠ‚ç‚¹ UDPã€QUICã€TFOï¼š
```
https://<your_host>:80/conflux?t=your_token&udp=1&quic=0&tfo=1
```

---

## è¾“å‡ºæ•ˆæœç¤ºä¾‹
```
æœºåœºA [TWğŸŒ]-01 = ss,server:port, encrypt-method=encrypt,password=password,tfo=1,udp-relay=1,block-quic=0
æœºåœºA [USğŸ‡ºğŸ‡¸]-01 = ss,server:port, encrypt-method=encrypt,password=password,tfo=1,udp-relay=1,block-quic=1
æœºåœºA [USğŸ‡ºğŸ‡¸]-02 = ss,server:port, encrypt-method=encrypt,password=password,tfo=1,udp-relay=1,block-quic=0
æœºåœºA [USğŸ‡ºğŸ‡¸]-03 = ss,server:port, encrypt-method=encrypt,password=password,tfo=1,udp-relay=1,block-quic=0
æœºåœºB [HKğŸ‡­ğŸ‡°]-01 = trojan,server:port, password=password,sni=server,tfo=1,udp-relay=1,block-quic=0
```

---

## é€‚ç”¨èŒƒå›´

- **ä»…é€‚ç”¨äº Surge**ï¼Œè¾“å‡ºèŠ‚ç‚¹æ ¼å¼ä¸ Surge å®Œå…¨å…¼å®¹ã€‚
- é€‚åˆå¤šæœºåœºç”¨æˆ·è‡ªåŠ¨èšåˆã€å¥åº·æ£€æµ‹ã€æ™ºèƒ½å¯¼å‡ºèŠ‚ç‚¹ã€‚
- é€šè¿‡ API å¯çµæ´»æ§åˆ¶èŠ‚ç‚¹å‚æ•°ï¼Œæ»¡è¶³ä¸åŒç½‘ç»œç¯å¢ƒéœ€æ±‚ã€‚

--- 

---

## é…å¥— Worker åä»£ï¼ˆå¯é€‰ï¼‰

**worker.js çš„ä½œç”¨**ï¼š

- ä½œä¸º Cloudflare Worker æˆ–å…¶ä»–å¹³å°éƒ¨ç½²ï¼Œ
- åå‘ä»£ç† Gist ä¸Šçš„èŠ‚ç‚¹é…ç½®æ–‡ä»¶ï¼ˆnode.confï¼‰ï¼Œ
- æ”¯æŒé€šè¿‡è‡ªå®šä¹‰åŸŸå/CDN åŠ é€Ÿè®¿é—®èŠ‚ç‚¹ï¼Œ
- æ”¯æŒ URL å‚æ•°åŠ¨æ€è¦†ç›–èŠ‚ç‚¹å±æ€§ï¼ˆå¦‚ udpã€quicã€tfoï¼‰ï¼Œ
- æ”¯æŒ token æƒé™æ ¡éªŒï¼Œæå‡å®‰å…¨æ€§ï¼Œ
- ä¾¿äº Surge ç”¨æˆ·åœ¨å›½å†…ç½‘ç»œç¯å¢ƒä¸‹æ›´å¿«ã€æ›´ç¨³å®šåœ°è·å–èŠ‚ç‚¹é…ç½®ã€‚

### ä½¿ç”¨æ–¹æ³•

1. å°†ä»“åº“ä¸­çš„ `worker.js` éƒ¨ç½²åˆ° Cloudflare Worker ç­‰å¹³å°ã€‚
2. è®¾ç½®ç¯å¢ƒå˜é‡ `GIST_URL` ä¸ºä½ çš„ Gist åŸå§‹é“¾æ¥ï¼ˆå¦‚ `https://gist.githubusercontent.com/xxx/raw/node.conf`ï¼‰ã€‚
3. è®¾ç½®ç¯å¢ƒå˜é‡ `TOKEN`ï¼Œå®ç°å®‰å…¨è®¿é—®ã€‚
4. è®¿é—®ä½ çš„ Worker åŸŸåå³å¯è·å–æœ€æ–°èŠ‚ç‚¹é…ç½®ã€‚

> Cloudflare éƒ¨ç½²æ—¶ï¼Œåœ¨ Worker è®¾ç½®ä¸­æ·»åŠ ç¯å¢ƒå˜é‡ `GIST_URL` å’Œ `TOKEN`ã€‚ 
